import tkinter as tk
from tkinter import ttk
from tkinter import messagebox
from tkcalendar import Calendar

# 創建主視窗
root = tk.Tk()
root.title("班級點名系統")

# 設置視窗大小
root.geometry("400x500")

# 標題
title_label = tk.Label(root, text="班級點名系統", font=("Helvetica", 16))
title_label.pack(pady=10)

# 班級座號和姓名選擇框架
student_frame = tk.Frame(root)
student_frame.pack(pady=10)

# 座號和姓名標籤
seat_label = tk.Label(student_frame, text="座號:")
seat_label.grid(row=0, column=0, padx=5, pady=5)
name_label = tk.Label(student_frame, text="姓名:")
name_label.grid(row=0, column=2, padx=5, pady=5)

# 座號和姓名選擇框
seat_number = ttk.Combobox(student_frame, values=[str(i) for i in range(1, 51)])
seat_number.grid(row=0, column=1, padx=5, pady=5)
name_entry = ttk.Entry(student_frame)
name_entry.grid(row=0, column=3, padx=5, pady=5)

# 日期選擇框架
date_frame = tk.Frame(root)
date_frame.pack(pady=10)

# 日期標籤
date_label = tk.Label(date_frame, text="選擇日期:")
date_label.grid(row=0, column=0, padx=5, pady=5)

# 日期選擇框
cal = Calendar(date_frame, selectmode='day', year=2023, month=7, day=1)
cal.grid(row=0, column=1, padx=5, pady=5)

# 出席狀況選擇框架
status_frame = tk.Frame(root)
status_frame.pack(pady=10)

# 出席狀況標籤
status_label = tk.Label(status_frame, text="出席狀況:")
status_label.grid(row=0, column=0, padx=5, pady=5)

# 出席狀況選項
status_var = tk.StringVar(value="出席")
attend_radio = ttk.Radiobutton(status_frame, text="出席", variable=status_var, value="出席")
attend_radio.grid(row=0, column=1, padx=5, pady=5)
absent_radio = ttk.Radiobutton(status_frame, text="缺席", variable=status_var, value="缺席")
absent_radio.grid(row=0, column=2, padx=5, pady=5)
late_radio = ttk.Radiobutton(status_frame, text="遲到", variable=status_var, value="遲到")
late_radio.grid(row=0, column=3, padx=5, pady=5)

# 按鈕框架
button_frame = tk.Frame(root)
button_frame.pack(pady=20)

# 送出和取消按鈕
def submit():
    seat = seat_number.get()
    name = name_entry.get()
    date = cal.get_date()
    status = status_var.get()
    
    if not seat or not name:
        messagebox.showerror("錯誤", "請填寫完整的座號和姓名")
    else:
        messagebox.showinfo("點名結果", f"座號: {seat}\n姓名: {name}\n日期: {date}\n出席狀況: {status}")

submit_button = ttk.Button(button_frame, text="送出", command=submit)
submit_button.grid(row=0, column=0, padx=10)

def cancel():
    seat_number.set("")
    name_entry.delete(0, tk.END)
    status_var.set("出席")
    cal.selection_clear()

cancel_button = ttk.Button(button_frame, text="取消", command=cancel)
cancel_button.grid(row=0, column=1, padx=10)

# 運行主循環
root.mainloop()
